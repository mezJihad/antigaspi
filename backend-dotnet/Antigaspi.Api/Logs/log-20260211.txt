2026-02-11 12:58:58.788 +01:00 [INF] Starting Database Seeding...
2026-02-11 12:59:12.787 +01:00 [FTL] An error occurred while seeding the database.
Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.UnpooledDataSource.Get(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlDatabaseCreator.Exists(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.ExistsAsync(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Migrations.HistoryRepository.GetAppliedMigrationsAsync(CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.MigrateAsync(String targetMigration, CancellationToken cancellationToken)
   at Program.<Main>$(String[] args) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Program.cs:line 98
2026-02-11 12:59:15.739 +01:00 [INF] Starting Application Host...
2026-02-11 12:59:16.542 +01:00 [INF] User profile is available. Using 'C:\Users\HP\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-02-11 12:59:18.526 +01:00 [INF] Now listening on: http://localhost:5131
2026-02-11 12:59:20.655 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2026-02-11 12:59:22.577 +01:00 [INF] Hosting environment: Development
2026-02-11 12:59:23.310 +01:00 [INF] Content root path: C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api
2026-02-11 12:59:26.401 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 12:59:26.410 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 12:59:26.702 +01:00 [WRN] Failed to determine the https port for redirect.
2026-02-11 12:59:26.717 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:26.717 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:26.757 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Offers?page=1&pageSize=12 - 204 null null 358.2521ms
2026-02-11 12:59:26.758 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Offers?page=1&pageSize=12 - 204 null null 355.0921ms
2026-02-11 12:59:27.284 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 12:59:27.632 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 12:59:27.634 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 12:59:27.647 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:27.671 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 204 null null 386.5333ms
2026-02-11 12:59:27.661 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:27.678 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:27.689 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 204 null null 55.2107ms
2026-02-11 12:59:27.696 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 12:59:27.768 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:27.912 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:27 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-02-11 12:59:27.912 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:27 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-02-11 12:59:27.954 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:27 AM'.
2026-02-11 12:59:27.970 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:27 AM'.
2026-02-11 12:59:27.995 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 12:59:27.995 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 12:59:28.084 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 12:59:28.084 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 12:59:29.558 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789172061643&lon=-7.634603338660499 - null null
2026-02-11 12:59:29.570 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:29.577 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789172061643&lon=-7.634603338660499 - 204 null null 18.8863ms
2026-02-11 12:59:29.601 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789172061643&lon=-7.634603338660499 - null null
2026-02-11 12:59:29.620 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:29.633 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:29 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-02-11 12:59:29.682 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:29 AM'.
2026-02-11 12:59:29.687 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 12:59:29.693 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 12:59:33.509 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 12:59:33.526 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 12:59:33.603 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 5481.6299ms
2026-02-11 12:59:33.613 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 12:59:33.626 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "e4132f89-48e4-48eb-a793-f5eedbe9fe16"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlOfferRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlOfferRepository.cs:line 39
   at Antigaspi.Application.UseCases.Offers.Queries.GetAllOffersQueryHandler.Handle(GetAllOffersQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Offers\Queries\GetAllOffersQuery.cs:line 31
   at Antigaspi.Api.Controllers.OffersController.GetAllOffers(Nullable`1 category, Nullable`1 lat, Nullable`1 lon, String city, String search, String sortBy, Int32 page, Int32 pageSize) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\OffersController.cs:line 185
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 12:59:33.825 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 12:59:33.839 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 12:59:33.899 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 500 null application/json 6265.9602ms
2026-02-11 12:59:33.966 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 12:59:34.007 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 5866.0205ms
2026-02-11 12:59:34.011 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:34.017 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 12:59:34.019 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:34 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-02-11 12:59:34.044 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:34 AM'.
2026-02-11 12:59:34.037 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "410979cc-3343-42bc-a416-695387fd1149"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlCityRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlCityRepository.cs:line 18
   at Antigaspi.Application.UseCases.Cities.Queries.GetAllCitiesQueryHandler.Handle(GetAllCitiesQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Cities\Queries\GetAllCitiesQuery.cs:line 21
   at Antigaspi.Api.Controllers.CitiesController.GetAll(Boolean onlyActiveOffers, String country) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\CitiesController.cs:line 21
   at lambda_method25(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 12:59:34.048 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 12:59:34.130 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 500 null application/json 6433.7725ms
2026-02-11 12:59:34.132 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 12:59:34.134 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 12:59:34.169 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:34.175 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:34 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-02-11 12:59:34.186 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '2/8/2026 5:52:49 PM', Current time (UTC): '2/11/2026 11:59:34 AM'.
2026-02-11 12:59:34.193 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 12:59:34.197 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 12:59:34.269 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 12:59:34.276 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 12:59:34.350 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 4640.9846ms
2026-02-11 12:59:34.356 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 12:59:34.360 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "4172eaaa-f6d2-4a58-a11e-d00448e06b3e"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlOfferRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlOfferRepository.cs:line 39
   at Antigaspi.Application.UseCases.Offers.Queries.GetAllOffersQueryHandler.Handle(GetAllOffersQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Offers\Queries\GetAllOffersQuery.cs:line 31
   at Antigaspi.Api.Controllers.OffersController.GetAllOffers(Nullable`1 category, Nullable`1 lat, Nullable`1 lon, String city, String search, String sortBy, Int32 page, Int32 pageSize) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\OffersController.cs:line 185
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 12:59:34.493 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789172061643&lon=-7.634603338660499 - 500 null application/json 4891.4959ms
2026-02-11 12:59:38.260 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 12:59:38.269 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 12:59:38.394 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 4190.5257ms
2026-02-11 12:59:38.401 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 12:59:38.410 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "80274a50-9f3c-4694-af9f-a3a987ef3767"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlCityRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlCityRepository.cs:line 18
   at Antigaspi.Application.UseCases.Cities.Queries.GetAllCitiesQueryHandler.Handle(GetAllCitiesQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Cities\Queries\GetAllCitiesQuery.cs:line 21
   at Antigaspi.Api.Controllers.CitiesController.GetAll(Boolean onlyActiveOffers, String country) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\CitiesController.cs:line 21
   at lambda_method25(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 12:59:38.701 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 500 null application/json 4566.5634ms
2026-02-11 12:59:38.730 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 12:59:38.747 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 12:59:38.952 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 4787.5989ms
2026-02-11 12:59:39.039 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 12:59:39.044 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "be7b51ea-6955-48ef-b72a-4ed7e03a27a6"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlOfferRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlOfferRepository.cs:line 39
   at Antigaspi.Application.UseCases.Offers.Queries.GetAllOffersQueryHandler.Handle(GetAllOffersQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Offers\Queries\GetAllOffersQuery.cs:line 31
   at Antigaspi.Api.Controllers.OffersController.GetAllOffers(Nullable`1 category, Nullable`1 lat, Nullable`1 lon, String city, String search, String sortBy, Int32 page, Int32 pageSize) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\OffersController.cs:line 185
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 12:59:39.406 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 500 null application/json 5439.9807ms
2026-02-11 12:59:45.218 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - null null
2026-02-11 12:59:45.232 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:45.236 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - 204 null null 18.6164ms
2026-02-11 12:59:45.261 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/login - application/json 56
2026-02-11 12:59:45.274 +01:00 [INF] CORS policy execution successful.
2026-02-11 12:59:45.277 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 12:59:45.289 +01:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Antigaspi.Api.Dtos.LoginRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 12:59:49.472 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 12:59:49.481 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 12:59:49.559 +01:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 12:59:49.576 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api) in 4278.5045ms
2026-02-11 12:59:49.581 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 12:59:49.584 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/login - 401 null application/json; charset=utf-8 4322.2518ms
2026-02-11 13:00:40.845 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 13:00:40.854 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:00:40.856 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:00:40.886 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:00:41.251 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 13:00:41.265 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:00:41.272 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:00:41.280 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 13:00:42.767 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789172061643&lon=-7.634603338660499 - null null
2026-02-11 13:00:42.773 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:00:42.778 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:00:42.781 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:00:44.963 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 13:00:44.986 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 13:00:45.055 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 4156.2138ms
2026-02-11 13:00:45.061 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:00:45.064 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "85c6dab3-0c86-46f0-b3fc-8d52fb434d6b"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlOfferRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlOfferRepository.cs:line 39
   at Antigaspi.Application.UseCases.Offers.Queries.GetAllOffersQueryHandler.Handle(GetAllOffersQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Offers\Queries\GetAllOffersQuery.cs:line 31
   at Antigaspi.Api.Controllers.OffersController.GetAllOffers(Nullable`1 category, Nullable`1 lat, Nullable`1 lon, String city, String search, String sortBy, Int32 page, Int32 pageSize) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\OffersController.cs:line 185
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 13:00:45.132 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 500 null application/json 4286.6719ms
2026-02-11 13:00:45.138 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 13:00:45.153 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:00:45.156 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:00:45.160 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:00:45.363 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 13:00:45.408 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 13:00:45.483 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 4194.7073ms
2026-02-11 13:00:45.486 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:00:45.489 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "edc95923-64aa-4019-858b-606360145666"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlCityRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlCityRepository.cs:line 18
   at Antigaspi.Application.UseCases.Cities.Queries.GetAllCitiesQueryHandler.Handle(GetAllCitiesQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Cities\Queries\GetAllCitiesQuery.cs:line 21
   at Antigaspi.Api.Controllers.CitiesController.GetAll(Boolean onlyActiveOffers, String country) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\CitiesController.cs:line 21
   at lambda_method25(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 13:00:45.555 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 500 null application/json 4304.1509ms
2026-02-11 13:00:45.556 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 13:00:45.573 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:00:45.576 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:00:45.580 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 13:00:46.830 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 13:00:46.839 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 13:00:46.927 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 4138.6043ms
2026-02-11 13:00:46.931 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:00:46.935 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "28ad61c6-04cf-4c9e-bba6-774cbf77a155"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlOfferRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlOfferRepository.cs:line 39
   at Antigaspi.Application.UseCases.Offers.Queries.GetAllOffersQueryHandler.Handle(GetAllOffersQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Offers\Queries\GetAllOffersQuery.cs:line 31
   at Antigaspi.Api.Controllers.OffersController.GetAllOffers(Nullable`1 category, Nullable`1 lat, Nullable`1 lon, String city, String search, String sortBy, Int32 page, Int32 pageSize) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\OffersController.cs:line 185
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 13:00:46.994 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789172061643&lon=-7.634603338660499 - 500 null application/json 4226.345ms
2026-02-11 13:00:49.237 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 13:00:49.279 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 13:00:49.336 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 4168.2021ms
2026-02-11 13:00:49.339 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:00:49.343 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "3561e47b-9b3b-44e6-943b-e4fd0f8570eb"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlOfferRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlOfferRepository.cs:line 39
   at Antigaspi.Application.UseCases.Offers.Queries.GetAllOffersQueryHandler.Handle(GetAllOffersQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Offers\Queries\GetAllOffersQuery.cs:line 31
   at Antigaspi.Api.Controllers.OffersController.GetAllOffers(Nullable`1 category, Nullable`1 lat, Nullable`1 lon, String city, String search, String sortBy, Int32 page, Int32 pageSize) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\OffersController.cs:line 185
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 13:00:49.396 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 500 null application/json 4257.7188ms
2026-02-11 13:00:49.652 +01:00 [ERR] An error occurred using the connection to database 'nogaspi' on server 'tcp://localhost:5432'.
2026-02-11 13:00:49.702 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Antigaspi.Infrastructure.Persistence.AntigaspiDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-02-11 13:00:49.792 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 4205.6484ms
2026-02-11 13:00:49.812 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:00:49.817 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "bb623051-4261-44e2-9a78-2b17f73cacf0"
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:5432
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.TaskTimeoutAndCancellation.ExecuteAsync(Func`2 getTaskFunc, NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|213_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|34_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Antigaspi.Infrastructure.Persistence.Repositories.SqlCityRepository.GetAllAsync(CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Persistence\Repositories\SqlCityRepository.cs:line 18
   at Antigaspi.Application.UseCases.Cities.Queries.GetAllCitiesQueryHandler.Handle(GetAllCitiesQuery request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Cities\Queries\GetAllCitiesQuery.cs:line 21
   at Antigaspi.Api.Controllers.CitiesController.GetAll(Boolean onlyActiveOffers, String country) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\CitiesController.cs:line 21
   at lambda_method25(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 13:00:49.881 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 500 null application/json 4324.2258ms
2026-02-11 13:03:19.925 +01:00 [INF] Application is shutting down...
2026-02-11 13:03:19.954 +01:00 [INF] Application Stopping...
2026-02-11 13:03:31.609 +01:00 [INF] Starting Database Seeding...
2026-02-11 13:03:33.762 +01:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 13:03:33.818 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-02-11 13:03:33.874 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 13:03:33.914 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 13:03:33.928 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-02-11 13:03:33.955 +01:00 [INF] No migrations were applied. The database is already up to date.
2026-02-11 13:03:34.061 +01:00 [INF] Seeding database...
2026-02-11 13:03:34.360 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = 'mez.jihad@gmail.com'
LIMIT 1
2026-02-11 13:03:34.876 +01:00 [INF] Executed DbCommand (24ms) [Parameters=[@p12='?' (DbType = Guid), @p0='?', @p1='?', @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "Email" = @p0, "FirstName" = @p1, "IsActive" = @p2, "IsEmailVerified" = @p3, "LastName" = @p4, "LastVerificationEmailSentAt" = @p5, "OtpCode" = @p6, "OtpExpiration" = @p7, "PasswordHash" = @p8, "PreferredLanguage" = @p9, "Role" = @p10, "VerificationEmailCount" = @p11
WHERE "Id" = @p12;
2026-02-11 13:03:34.897 +01:00 [INF] Admin seeded / updated.
2026-02-11 13:03:34.935 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Cities" AS c)
2026-02-11 13:03:34.964 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Sellers" AS s)
2026-02-11 13:03:34.999 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Offers" AS o)
2026-02-11 13:03:35.015 +01:00 [INF] Database seeded successfully.
2026-02-11 13:03:35.024 +01:00 [INF] Database Seeding Completed.
2026-02-11 13:03:35.026 +01:00 [INF] Starting Application Host...
2026-02-11 13:03:35.057 +01:00 [INF] User profile is available. Using 'C:\Users\HP\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-02-11 13:03:35.149 +01:00 [INF] Now listening on: http://localhost:5131
2026-02-11 13:03:35.152 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2026-02-11 13:03:35.156 +01:00 [INF] Hosting environment: Development
2026-02-11 13:03:35.162 +01:00 [INF] Content root path: C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api
2026-02-11 13:04:34.928 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 13:04:35.029 +01:00 [WRN] Failed to determine the https port for redirect.
2026-02-11 13:04:35.036 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:35.099 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:35.144 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 13:04:35.155 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:35.157 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:04:35.166 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:35.187 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 13:04:35.297 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 13:04:35.432 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:35.468 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:35.616 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 13:04:35.616 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:04:35.684 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 13:04:35.686 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 487.2538ms
2026-02-11 13:04:35.697 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:35.702 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:35.705 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:35.713 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 13:04:35.717 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 572.2741ms
2026-02-11 13:04:35.763 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 593.8124ms
2026-02-11 13:04:35.770 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:35.771 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 13:04:35.778 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 853.3605ms
2026-02-11 13:04:35.776 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 13:04:35.787 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:35.813 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:35.815 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:35.822 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:04:35.836 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:04:35.843 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 96.5598ms
2026-02-11 13:04:35.847 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:35.851 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:35.863 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 178.433ms
2026-02-11 13:04:35.864 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 13:04:35.885 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 43.8957ms
2026-02-11 13:04:35.889 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:35.893 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 121.9991ms
2026-02-11 13:04:37.028 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.587902365327146&lon=-7.634654819165378 - null null
2026-02-11 13:04:37.035 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:37.037 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:37.043 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:04:37.072 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:37.087 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 13:04:37.095 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 43.5167ms
2026-02-11 13:04:37.101 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:37.103 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.587902365327146&lon=-7.634654819165378 - 200 null application/json; charset=utf-8 75.3336ms
2026-02-11 13:04:39.881 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - null null
2026-02-11 13:04:39.891 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:39.895 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - 204 null null 13.0277ms
2026-02-11 13:04:39.910 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/login - application/json 56
2026-02-11 13:04:39.920 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:39.924 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 13:04:39.936 +01:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Antigaspi.Api.Dtos.LoginRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 13:04:40.021 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = @__email_0
LIMIT 1
2026-02-11 13:04:40.325 +01:00 [INF] Executing OkObjectResult, writing value of type 'Antigaspi.Api.Dtos.AuthResponse'.
2026-02-11 13:04:40.331 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api) in 388.222ms
2026-02-11 13:04:40.334 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 13:04:40.337 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/login - 200 null application/json; charset=utf-8 426.4218ms
2026-02-11 13:04:40.378 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:04:40.383 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:04:40.393 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:40.400 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - 204 null null 22.1673ms
2026-02-11 13:04:40.398 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:40.409 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - 204 null null 25.8907ms
2026-02-11 13:04:40.414 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:04:40.431 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:40.485 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:04:40.490 +01:00 [INF] Route matched with {action = "GetUsersOverview", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersOverview() on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 13:04:40.579 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount", s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode", CASE
    WHEN s."Id" IS NOT NULL THEN (
        SELECT count(*)::int
        FROM "Offers" AS o
        WHERE o."SellerId" = s."Id")
    ELSE 0
END
FROM "Users" AS u
LEFT JOIN "Sellers" AS s ON u."Id" = s."UserId"
2026-02-11 13:04:40.638 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[<>f__AnonymousType8`3[[Antigaspi.Domain.Entities.User, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Domain.Entities.Seller, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], Antigaspi.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Application.Dtos.AdminUserSummaryDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:04:40.685 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api) in 191.3435ms
2026-02-11 13:04:40.686 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:04:40.692 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:04:40.695 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:40.698 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - 200 null application/json; charset=utf-8 284.312ms
2026-02-11 13:04:40.704 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:04:40.715 +01:00 [INF] Route matched with {action = "GetUsersOverview", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersOverview() on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 13:04:40.732 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount", s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode", CASE
    WHEN s."Id" IS NOT NULL THEN (
        SELECT count(*)::int
        FROM "Offers" AS o
        WHERE o."SellerId" = s."Id")
    ELSE 0
END
FROM "Users" AS u
LEFT JOIN "Sellers" AS s ON u."Id" = s."UserId"
2026-02-11 13:04:40.752 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[<>f__AnonymousType8`3[[Antigaspi.Domain.Entities.User, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Domain.Entities.Seller, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], Antigaspi.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Application.Dtos.AdminUserSummaryDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:04:40.763 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api) in 37.6866ms
2026-02-11 13:04:40.772 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:04:40.778 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - 200 null application/json; charset=utf-8 91.7394ms
2026-02-11 13:04:53.984 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 13:04:54.003 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:54.009 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:54.016 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:04:54.037 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:54.059 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 13:04:54.093 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 13:04:54.099 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 13:04:54.094 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 61.0903ms
2026-02-11 13:04:54.125 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:54.114 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:54.158 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 173.5021ms
2026-02-11 13:04:54.137 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:54.158 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.587902365327146&lon=-7.634654819165378 - null null
2026-02-11 13:04:54.186 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:54.195 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:54.194 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:54.197 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:54.204 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 13:04:54.208 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:04:54.206 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 13:04:54.218 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 13:04:54.228 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:54.253 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:54.254 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 13:04:54.281 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:04:54.286 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 66.4216ms
2026-02-11 13:04:54.309 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:54.304 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 90.4515ms
2026-02-11 13:04:54.319 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:54.307 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 13:04:54.332 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:54.313 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.587902365327146&lon=-7.634654819165378 - 200 null application/json; charset=utf-8 154.5021ms
2026-02-11 13:04:54.343 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:04:54.365 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:54.359 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 13:04:54.373 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 279.9446ms
2026-02-11 13:04:54.403 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 13:04:54.398 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 163.0471ms
2026-02-11 13:04:54.414 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 13:04:54.421 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 13:04:54.424 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 323.8032ms
2026-02-11 13:04:54.459 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 13:04:54.477 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:04:54.485 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 66.8722ms
2026-02-11 13:04:54.494 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 13:04:54.501 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 193.5366ms
2026-02-11 13:49:01.207 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - null null
2026-02-11 13:49:01.219 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:49:01.224 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - 204 null null 17.1929ms
2026-02-11 13:49:01.235 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/login - application/json 56
2026-02-11 13:49:01.241 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:49:01.244 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 13:49:01.246 +01:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Antigaspi.Api.Dtos.LoginRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 13:49:01.299 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = @__email_0
LIMIT 1
2026-02-11 13:49:01.453 +01:00 [INF] Executing OkObjectResult, writing value of type 'Antigaspi.Api.Dtos.AuthResponse'.
2026-02-11 13:49:01.457 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api) in 204.8195ms
2026-02-11 13:49:01.461 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 13:49:01.465 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/login - 200 null application/json; charset=utf-8 229.7034ms
2026-02-11 13:49:01.501 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:49:01.501 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:49:01.510 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:49:01.514 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:49:01.516 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - 204 null null 14.3044ms
2026-02-11 13:49:01.521 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - 204 null null 19.5192ms
2026-02-11 13:49:01.524 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:49:01.536 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:49:01.540 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:49:01.543 +01:00 [INF] Route matched with {action = "GetUsersOverview", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersOverview() on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 13:49:01.566 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount", s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode", CASE
    WHEN s."Id" IS NOT NULL THEN (
        SELECT count(*)::int
        FROM "Offers" AS o
        WHERE o."SellerId" = s."Id")
    ELSE 0
END
FROM "Users" AS u
LEFT JOIN "Sellers" AS s ON u."Id" = s."UserId"
2026-02-11 13:49:01.575 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[<>f__AnonymousType8`3[[Antigaspi.Domain.Entities.User, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Domain.Entities.Seller, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], Antigaspi.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Application.Dtos.AdminUserSummaryDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:49:01.581 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api) in 32.8659ms
2026-02-11 13:49:01.582 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 13:49:01.588 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:49:01.591 +01:00 [INF] CORS policy execution successful.
2026-02-11 13:49:01.595 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - 200 null application/json; charset=utf-8 70.4736ms
2026-02-11 13:49:01.596 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:49:01.611 +01:00 [INF] Route matched with {action = "GetUsersOverview", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersOverview() on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 13:49:01.625 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount", s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode", CASE
    WHEN s."Id" IS NOT NULL THEN (
        SELECT count(*)::int
        FROM "Offers" AS o
        WHERE o."SellerId" = s."Id")
    ELSE 0
END
FROM "Users" AS u
LEFT JOIN "Sellers" AS s ON u."Id" = s."UserId"
2026-02-11 13:49:01.635 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[<>f__AnonymousType8`3[[Antigaspi.Domain.Entities.User, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Domain.Entities.Seller, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], Antigaspi.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Application.Dtos.AdminUserSummaryDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 13:49:01.641 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api) in 21.9621ms
2026-02-11 13:49:01.645 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 13:49:01.649 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - 200 null application/json; charset=utf-8 67.0892ms
2026-02-11 14:06:38.080 +01:00 [INF] Application is shutting down...
2026-02-11 14:06:38.113 +01:00 [INF] Application Stopping...
2026-02-11 14:07:20.848 +01:00 [INF] Starting Database Seeding...
2026-02-11 14:07:23.400 +01:00 [INF] Executed DbCommand (93ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 14:07:23.483 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-02-11 14:07:23.566 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 14:07:23.640 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 14:07:23.656 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-02-11 14:07:23.703 +01:00 [INF] No migrations were applied. The database is already up to date.
2026-02-11 14:07:23.722 +01:00 [INF] Seeding database...
2026-02-11 14:07:24.151 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = 'mez.jihad@gmail.com'
LIMIT 1
2026-02-11 14:07:24.780 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[@p12='?' (DbType = Guid), @p0='?', @p1='?', @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "Email" = @p0, "FirstName" = @p1, "IsActive" = @p2, "IsEmailVerified" = @p3, "LastName" = @p4, "LastVerificationEmailSentAt" = @p5, "OtpCode" = @p6, "OtpExpiration" = @p7, "PasswordHash" = @p8, "PreferredLanguage" = @p9, "Role" = @p10, "VerificationEmailCount" = @p11
WHERE "Id" = @p12;
2026-02-11 14:07:24.808 +01:00 [INF] Admin seeded / updated.
2026-02-11 14:07:24.874 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Cities" AS c)
2026-02-11 14:07:24.902 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Sellers" AS s)
2026-02-11 14:07:24.929 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Offers" AS o)
2026-02-11 14:07:24.949 +01:00 [INF] Database seeded successfully.
2026-02-11 14:07:24.964 +01:00 [INF] Database Seeding Completed.
2026-02-11 14:07:24.967 +01:00 [INF] Starting Application Host...
2026-02-11 14:07:25.006 +01:00 [INF] User profile is available. Using 'C:\Users\HP\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-02-11 14:07:25.115 +01:00 [INF] Now listening on: http://localhost:5131
2026-02-11 14:07:25.119 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2026-02-11 14:07:25.122 +01:00 [INF] Hosting environment: Development
2026-02-11 14:07:25.126 +01:00 [INF] Content root path: C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api
2026-02-11 14:07:30.914 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 14:07:31.029 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 14:07:31.040 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789665862741&lon=-7.634613080207042 - null null
2026-02-11 14:07:31.073 +01:00 [WRN] Failed to determine the https port for redirect.
2026-02-11 14:07:31.079 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:07:31.079 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:07:31.079 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:07:31.136 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:07:31.136 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:07:31.136 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:07:31.188 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 14:07:31.188 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 14:07:31.188 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 14:07:31.381 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 14:07:31.565 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:07:31.596 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:07:31.614 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:07:31.777 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:07:31.777 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 14:07:31.777 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:07:31.844 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 14:07:31.846 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 642.3212ms
2026-02-11 14:07:31.856 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:07:31.858 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:07:31.865 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:07:31.873 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 842.9324ms
2026-02-11 14:07:31.873 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 14:07:31.891 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 678.0294ms
2026-02-11 14:07:31.891 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 675.9127ms
2026-02-11 14:07:31.894 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 14:07:31.903 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 14:07:31.903 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:07:31.905 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:07:31.909 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:07:31.921 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 1013.4539ms
2026-02-11 14:07:31.922 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58789665862741&lon=-7.634613080207042 - 200 null application/json; charset=utf-8 882.5238ms
2026-02-11 14:07:31.925 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:07:31.924 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:07:31.959 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 14:07:31.961 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 14:07:31.968 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 75.6937ms
2026-02-11 14:07:31.973 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:07:31.976 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:07:31.978 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 133.3245ms
2026-02-11 14:07:31.992 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:07:31.999 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 32.5419ms
2026-02-11 14:07:32.003 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:07:32.006 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 111.2353ms
2026-02-11 14:08:25.131 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/register - null null
2026-02-11 14:08:25.145 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:08:25.148 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/register - 204 null null 17.4188ms
2026-02-11 14:08:25.162 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/register - application/json 132
2026-02-11 14:08:25.172 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:08:25.177 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api)'
2026-02-11 14:08:25.184 +01:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Antigaspi.Api.Dtos.RegisterRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 14:08:25.250 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = @__email_0
LIMIT 1
2026-02-11 14:08:25.440 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?', @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?', @p6='?' (DbType = DateTime), @p7='?', @p8='?' (DbType = DateTime), @p9='?', @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Id", "Email", "FirstName", "IsActive", "IsEmailVerified", "LastName", "LastVerificationEmailSentAt", "OtpCode", "OtpExpiration", "PasswordHash", "PreferredLanguage", "Role")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING "VerificationEmailCount";
2026-02-11 14:08:26.195 +01:00 [ERR] Failed to send template email to elkhaoi.mouhcine@gmail.com. Status: "Unauthorized". Error: {"message":"Key not found","code":"unauthorized"}

2026-02-11 14:08:26.202 +01:00 [ERR] Exception occurred while sending template email to elkhaoi.mouhcine@gmail.com via Brevo API.
System.Exception: Brevo API Error: Unauthorized - {"message":"Key not found","code":"unauthorized"}

   at Antigaspi.Infrastructure.Services.BrevoApiEmailService.SendTemplateEmailAsync(String to, Int64 templateId, Dictionary`2 parameters) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Services\BrevoApiEmailService.cs:line 114
2026-02-11 14:08:26.238 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api) in 1048.5802ms
2026-02-11 14:08:26.244 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api)'
2026-02-11 14:08:26.248 +01:00 [ERR] An unhandled exception has occurred. ErrorId: "e0de2950-4e96-4382-8666-dd25df62156b"
System.Exception: Brevo API Error: Unauthorized - {"message":"Key not found","code":"unauthorized"}

   at Antigaspi.Infrastructure.Services.BrevoApiEmailService.SendTemplateEmailAsync(String to, Int64 templateId, Dictionary`2 parameters) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Infrastructure\Services\BrevoApiEmailService.cs:line 114
   at Antigaspi.Application.UseCases.Auth.Commands.RegisterUserCommandHandler.Handle(RegisterUserCommand request, CancellationToken cancellationToken) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Application\UseCases\Auth\Commands\RegisterUserCommand.cs:line 93
   at Antigaspi.Api.Controllers.AuthController.Register(RegisterRequest request) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Controllers\AuthController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Antigaspi.Api.Middleware.GlobalExceptionHandlerMiddleware.Invoke(HttpContext context) in C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api\Middleware\GlobalExceptionHandlerMiddleware.cs:line 20
2026-02-11 14:08:26.300 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/register - 500 null application/json 1137.7271ms
2026-02-11 14:11:29.087 +01:00 [INF] Application is shutting down...
2026-02-11 14:11:29.123 +01:00 [INF] Application Stopping...
2026-02-11 14:11:38.181 +01:00 [INF] Starting Database Seeding...
2026-02-11 14:11:39.841 +01:00 [INF] Executed DbCommand (63ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 14:11:39.890 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-02-11 14:11:39.941 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 14:11:39.980 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2026-02-11 14:11:39.997 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-02-11 14:11:40.030 +01:00 [INF] No migrations were applied. The database is already up to date.
2026-02-11 14:11:40.046 +01:00 [INF] Seeding database...
2026-02-11 14:11:40.385 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = 'mez.jihad@gmail.com'
LIMIT 1
2026-02-11 14:11:40.920 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p12='?' (DbType = Guid), @p0='?', @p1='?', @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Users" SET "Email" = @p0, "FirstName" = @p1, "IsActive" = @p2, "IsEmailVerified" = @p3, "LastName" = @p4, "LastVerificationEmailSentAt" = @p5, "OtpCode" = @p6, "OtpExpiration" = @p7, "PasswordHash" = @p8, "PreferredLanguage" = @p9, "Role" = @p10, "VerificationEmailCount" = @p11
WHERE "Id" = @p12;
2026-02-11 14:11:40.943 +01:00 [INF] Admin seeded / updated.
2026-02-11 14:11:40.984 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Cities" AS c)
2026-02-11 14:11:41.006 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Sellers" AS s)
2026-02-11 14:11:41.036 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Offers" AS o)
2026-02-11 14:11:41.067 +01:00 [INF] Database seeded successfully.
2026-02-11 14:11:41.093 +01:00 [INF] Database Seeding Completed.
2026-02-11 14:11:41.096 +01:00 [INF] Starting Application Host...
2026-02-11 14:11:41.128 +01:00 [INF] User profile is available. Using 'C:\Users\HP\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-02-11 14:11:41.235 +01:00 [INF] Now listening on: http://localhost:5131
2026-02-11 14:11:41.240 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2026-02-11 14:11:41.245 +01:00 [INF] Hosting environment: Development
2026-02-11 14:11:41.252 +01:00 [INF] Content root path: C:\Users\HP\source\repos\AntiGaspi\antigaspi\backend-dotnet\Antigaspi.Api
2026-02-11 14:12:06.332 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/register - null null
2026-02-11 14:12:06.400 +01:00 [WRN] Failed to determine the https port for redirect.
2026-02-11 14:12:06.406 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:06.466 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/register - 204 null null 134.4251ms
2026-02-11 14:12:06.691 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/register - application/json 132
2026-02-11 14:12:06.716 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:06.750 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api)'
2026-02-11 14:12:06.782 +01:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Antigaspi.Api.Dtos.RegisterRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 14:12:06.975 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = @__email_0
LIMIT 1
2026-02-11 14:12:07.007 +01:00 [INF] Executing ConflictObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:12:07.043 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api) in 248.9471ms
2026-02-11 14:12:07.051 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api)'
2026-02-11 14:12:07.075 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/register - 409 null application/json; charset=utf-8 384.2727ms
2026-02-11 14:12:22.940 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - null null
2026-02-11 14:12:22.965 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:22.980 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - 204 null null 40.5469ms
2026-02-11 14:12:23.000 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/login - application/json 63
2026-02-11 14:12:23.025 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:23.033 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 14:12:23.056 +01:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Antigaspi.Api.Dtos.LoginRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 14:12:23.113 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = @__email_0
LIMIT 1
2026-02-11 14:12:23.125 +01:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:12:23.133 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api) in 66.3966ms
2026-02-11 14:12:23.141 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 14:12:23.149 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/login - 401 null application/json; charset=utf-8 148.9733ms
2026-02-11 14:12:47.004 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - null null
2026-02-11 14:12:47.037 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:47.043 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/login - 204 null null 38.8623ms
2026-02-11 14:12:47.061 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/login - application/json 56
2026-02-11 14:12:47.076 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:47.084 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 14:12:47.093 +01:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Antigaspi.Api.Dtos.LoginRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 14:12:47.126 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = @__email_0
LIMIT 1
2026-02-11 14:12:47.399 +01:00 [INF] Executing OkObjectResult, writing value of type 'Antigaspi.Api.Dtos.AuthResponse'.
2026-02-11 14:12:47.407 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api) in 290.5127ms
2026-02-11 14:12:47.411 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Login (Antigaspi.Api)'
2026-02-11 14:12:47.418 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/login - 200 null application/json; charset=utf-8 356.9524ms
2026-02-11 14:12:47.497 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 14:12:47.529 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 14:12:47.535 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:47.545 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - 204 null null 48.3853ms
2026-02-11 14:12:47.555 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:47.571 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 14:12:47.578 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - 204 null null 48.7888ms
2026-02-11 14:12:47.643 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:47.762 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 14:12:47.775 +01:00 [INF] Route matched with {action = "GetUsersOverview", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersOverview() on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 14:12:47.950 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount", s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode", CASE
    WHEN s."Id" IS NOT NULL THEN (
        SELECT count(*)::int
        FROM "Offers" AS o
        WHERE o."SellerId" = s."Id")
    ELSE 0
END
FROM "Users" AS u
LEFT JOIN "Sellers" AS s ON u."Id" = s."UserId"
2026-02-11 14:12:48.026 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[<>f__AnonymousType8`3[[Antigaspi.Domain.Entities.User, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Domain.Entities.Seller, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], Antigaspi.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Application.Dtos.AdminUserSummaryDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 14:12:48.087 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api) in 301.007ms
2026-02-11 14:12:48.088 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 14:12:48.096 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:48.099 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 14:12:48.109 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - 200 null application/json; charset=utf-8 537.2984ms
2026-02-11 14:12:48.109 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 14:12:48.126 +01:00 [INF] Route matched with {action = "GetUsersOverview", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersOverview() on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 14:12:48.154 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount", s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode", CASE
    WHEN s."Id" IS NOT NULL THEN (
        SELECT count(*)::int
        FROM "Offers" AS o
        WHERE o."SellerId" = s."Id")
    ELSE 0
END
FROM "Users" AS u
LEFT JOIN "Sellers" AS s ON u."Id" = s."UserId"
2026-02-11 14:12:48.187 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[<>f__AnonymousType8`3[[Antigaspi.Domain.Entities.User, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Domain.Entities.Seller, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], Antigaspi.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Application.Dtos.AdminUserSummaryDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 14:12:48.201 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api) in 56.0709ms
2026-02-11 14:12:48.221 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 14:12:48.243 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - 200 null application/json; charset=utf-8 155.704ms
2026-02-11 14:12:55.818 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users/d28b65c6-b1e3-4c97-bf96-7de7f4fa98fd - null null
2026-02-11 14:12:55.844 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:55.859 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users/d28b65c6-b1e3-4c97-bf96-7de7f4fa98fd - 204 null null 40.883ms
2026-02-11 14:12:55.884 +01:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5131/api/Admin/users/d28b65c6-b1e3-4c97-bf96-7de7f4fa98fd - null null
2026-02-11 14:12:55.894 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:55.903 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.DeleteUser (Antigaspi.Api)'
2026-02-11 14:12:55.927 +01:00 [INF] Route matched with {action = "DeleteUser", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteUser(System.Guid) on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 14:12:55.978 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Id" = @__id_0
LIMIT 1
2026-02-11 14:12:56.007 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Sellers" AS s
WHERE s."UserId" = @__userId_0
LIMIT 1
2026-02-11 14:12:56.053 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Users"
WHERE "Id" = @p0;
2026-02-11 14:12:56.076 +01:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2026-02-11 14:12:56.077 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.DeleteUser (Antigaspi.Api) in 135.1572ms
2026-02-11 14:12:56.083 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.DeleteUser (Antigaspi.Api)'
2026-02-11 14:12:56.087 +01:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5131/api/Admin/users/d28b65c6-b1e3-4c97-bf96-7de7f4fa98fd - 204 null null 202.9767ms
2026-02-11 14:12:56.110 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 14:12:56.119 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:56.125 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Admin/users-overview - 204 null null 14.9655ms
2026-02-11 14:12:56.137 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - null null
2026-02-11 14:12:56.191 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:56.210 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 14:12:56.220 +01:00 [INF] Route matched with {action = "GetUsersOverview", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersOverview() on controller Antigaspi.Api.Controllers.AdminController (Antigaspi.Api).
2026-02-11 14:12:56.277 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount", s."Id", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode", CASE
    WHEN s."Id" IS NOT NULL THEN (
        SELECT count(*)::int
        FROM "Offers" AS o
        WHERE o."SellerId" = s."Id")
    ELSE 0
END
FROM "Users" AS u
LEFT JOIN "Sellers" AS s ON u."Id" = s."UserId"
2026-02-11 14:12:56.312 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+SelectListIterator`2[[<>f__AnonymousType8`3[[Antigaspi.Domain.Entities.User, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Domain.Entities.Seller, Antigaspi.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], Antigaspi.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Antigaspi.Application.Dtos.AdminUserSummaryDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 14:12:56.320 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api) in 58.3575ms
2026-02-11 14:12:56.392 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AdminController.GetUsersOverview (Antigaspi.Api)'
2026-02-11 14:12:56.395 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Admin/users-overview - 200 null application/json; charset=utf-8 258.3131ms
2026-02-11 14:12:57.991 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 14:12:58.010 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:58.015 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:12:58.057 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 14:12:58.139 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58790174526827&lon=-7.634617301288778 - null null
2026-02-11 14:12:58.149 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:58.151 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:12:58.158 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 14:12:58.274 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:12:58.341 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:12:58.524 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:12:58.525 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:12:58.606 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 437.492ms
2026-02-11 14:12:58.606 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 538.3622ms
2026-02-11 14:12:58.615 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:12:58.624 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:12:58.609 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - null null
2026-02-11 14:12:58.633 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12&lat=33.58790174526827&lon=-7.634617301288778 - 200 null application/json; charset=utf-8 494.4633ms
2026-02-11 14:12:58.669 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:12:58.678 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 686.3361ms
2026-02-11 14:12:58.694 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:12:58.718 +01:00 [INF] Route matched with {action = "GetAllOffers", controller = "Offers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllOffers(System.Nullable`1[Antigaspi.Domain.Enums.OfferCategory], System.Nullable`1[System.Double], System.Nullable`1[System.Double], System.String, System.String, System.String, Int32, Int32) on controller Antigaspi.Api.Controllers.OffersController (Antigaspi.Api).
2026-02-11 14:12:58.748 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:12:58.768 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`6[[System.Collections.Generic.IEnumerable`1[[Antigaspi.Api.Dtos.OfferResponse, Antigaspi.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:12:58.809 +01:00 [INF] Executed action Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api) in 72.2949ms
2026-02-11 14:12:58.830 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.OffersController.GetAllOffers (Antigaspi.Api)'
2026-02-11 14:12:58.845 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Offers?page=1&pageSize=12 - 200 null application/json; charset=utf-8 235.6744ms
2026-02-11 14:13:08.240 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 14:13:08.255 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:13:08.267 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:13:08.283 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 14:13:08.318 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 14:13:08.331 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:13:08.347 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 14:13:08.351 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 60.0228ms
2026-02-11 14:13:08.358 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:13:08.376 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 135.8765ms
2026-02-11 14:13:08.415 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - null null
2026-02-11 14:13:08.425 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:13:08.429 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:13:08.433 +01:00 [INF] Route matched with {action = "GetAll", controller = "Cities"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Antigaspi.Application.UseCases.Cities.Queries.CityDto]]] GetAll(Boolean, System.String) on controller Antigaspi.Api.Controllers.CitiesController (Antigaspi.Api).
2026-02-11 14:13:08.460 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."IsActive", c."NameAr", c."NameEn", c."NameFr"
FROM "Cities" AS c
WHERE c."IsActive"
ORDER BY c."NameFr"
2026-02-11 14:13:08.498 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Category", o."Description", o."EndDate", o."ExpirationDate", o."PictureUrl", o."SellerId", o."SourceLanguage", o."StartDate", o."Status", o."Title", o."OriginalPriceAmount", o."OriginalPriceCurrency", o."PriceAmount", o."PriceCurrency", s."Id", o0."OfferId", o0."Id", o0."ChangedAt", o0."ChangedBy", o0."Reason", o0."Status", s."Description", s."RejectionReason", s."SourceLanguage", s."Status", s."StoreName", s."UserId", s."City", s."Country", s."Latitude", s."Longitude", s."Street", s."ZipCode"
FROM "Offers" AS o
INNER JOIN "Sellers" AS s ON o."SellerId" = s."Id"
LEFT JOIN "OfferStatusHistory" AS o0 ON o."Id" = o0."OfferId"
ORDER BY o."Id", s."Id", o0."OfferId"
2026-02-11 14:13:08.515 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Antigaspi.Application.UseCases.Cities.Queries.CityDto, Antigaspi.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-02-11 14:13:08.523 +01:00 [INF] Executed action Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api) in 71.4221ms
2026-02-11 14:13:08.526 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.CitiesController.GetAll (Antigaspi.Api)'
2026-02-11 14:13:08.533 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5131/api/Cities?onlyActiveOffers=true&country=Maroc - 200 null application/json; charset=utf-8 118.059ms
2026-02-11 14:13:14.579 +01:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/register - null null
2026-02-11 14:13:14.597 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:13:14.600 +01:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5131/api/Auth/register - 204 null null 20.8789ms
2026-02-11 14:13:14.630 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5131/api/Auth/register - application/json 132
2026-02-11 14:13:14.640 +01:00 [INF] CORS policy execution successful.
2026-02-11 14:13:14.642 +01:00 [INF] Executing endpoint 'Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api)'
2026-02-11 14:13:14.648 +01:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Antigaspi.Api.Dtos.RegisterRequest) on controller Antigaspi.Api.Controllers.AuthController (Antigaspi.Api).
2026-02-11 14:13:14.665 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Email", u."FirstName", u."IsActive", u."IsEmailVerified", u."LastName", u."LastVerificationEmailSentAt", u."OtpCode", u."OtpExpiration", u."PasswordHash", u."PreferredLanguage", u."Role", u."VerificationEmailCount"
FROM "Users" AS u
WHERE u."Email" = @__email_0
LIMIT 1
2026-02-11 14:13:14.888 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?', @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?', @p6='?' (DbType = DateTime), @p7='?', @p8='?' (DbType = DateTime), @p9='?', @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Users" ("Id", "Email", "FirstName", "IsActive", "IsEmailVerified", "LastName", "LastVerificationEmailSentAt", "OtpCode", "OtpExpiration", "PasswordHash", "PreferredLanguage", "Role")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING "VerificationEmailCount";
2026-02-11 14:13:15.863 +01:00 [INF] Template Email 6 sent successfully to elkhaoi.mouhcine@gmail.com via Brevo API.
2026-02-11 14:13:15.868 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-02-11 14:13:15.879 +01:00 [INF] Executed action Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api) in 1221.775ms
2026-02-11 14:13:15.882 +01:00 [INF] Executed endpoint 'Antigaspi.Api.Controllers.AuthController.Register (Antigaspi.Api)'
2026-02-11 14:13:15.888 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5131/api/Auth/register - 200 null application/json; charset=utf-8 1257.6126ms
